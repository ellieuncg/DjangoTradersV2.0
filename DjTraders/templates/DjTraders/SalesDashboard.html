{% extends "base.html" %}
{% load static %}
{% block title %}Product Sales Dashboard{% endblock %}
{% block content %}

<div class="sales-dashboard">
    <!-- Page Header -->
    <header class="page-header">
        <h1 class="dashboard-title">Product Sales Dashboard</h1>
        <h2 id="product_name" class="dashboard-subtitle">{{ product_name }}</h2>

        <!-- Filter Section -->
        <div class="filter-section">
            <label for="year" class="filter-label">Year:</label>
            <select id="year" class="filter-select">
                {% for year in available_years %}
                    <option value="{{ year }}" {% if year == selected_year %}selected{% endif %}>{{ year }}</option>
                {% endfor %}
            </select>

            <label for="product" class="filter-label">Product:</label>
            <select id="product" class="filter-select">
                <option value="">All Products</option>
                {% for product in products %}
                    <option value="{{ product.product_id }}" {% if product.product_id == selected_product %}selected{% endif %}>
                        {{ product.product_name }}
                    </option>
                {% endfor %}
            </select>

            <button id="applyFilters" class="btn btn-primary">Apply Filters</button>
        </div>
    </header>

    <!-- Sales Tabs -->
    <div class="sales-tabs">
        <button class="tab-btn active" data-tab="tab-annual-overview">Annual Sales</button>
        <button class="tab-btn" data-tab="tab-top-products">Top Products</button>
        <button class="tab-btn" data-tab="tab-bottom-products">Bottom Products</button>
        <button class="tab-btn" data-tab="tab-category-analysis">Category Sales</button>
    </div>

    <!-- Tab Content -->
    <div class="tab-content active" id="tab-annual-overview">
        <h2 class="tab-title">Annual Sales Overview</h2>
        <canvas id="annualSalesChart" class="chart-canvas"></canvas>
    </div>
    <div class="tab-content" id="tab-top-products">
        <h2 class="tab-title">Top 10 Products</h2>
        <canvas id="topProductsChart" class="chart-canvas"></canvas>
    </div>
    <div class="tab-content" id="tab-bottom-products">
        <h2 class="tab-title">Bottom 10 Products</h2>
        <canvas id="bottomProductsChart" class="chart-canvas"></canvas>
    </div>
    <div class="tab-content" id="tab-category-analysis">
        <h2 class="tab-title">Category Sales Analysis</h2>
        <canvas id="categorySalesChart" class="chart-canvas"></canvas>
    </div>
</div>

{% endblock %}
{% block extra_js %}
    {# Inject Sales Dashboard Data #}
    <script>
        window.salesDashboardData = {
            annualSalesLabels: {{ annual_sales_labels|safe }},
            annualSalesData: {{ annual_sales_data|safe }},
            topProductsLabels: {{ top_products_labels|safe }},
            topProductsData: {{ top_products_data|safe }},
            bottomProductsLabels: {{ bottom_products_labels|safe }},
            bottomProductsData: {{ bottom_products_data|safe }},
            categorySalesLabels: {{ category_sales_labels|safe }},
            categorySalesData: {{ category_sales_data|safe }}
        };
    </script>
{% endblock %}
